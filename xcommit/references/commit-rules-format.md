# COMMIT-RULES.md 规范

## 生成方式

两层来源提取（不是凭空编）：
1. **CLAUDE.md**（如存在）→ 提取提交相关规则（禁止部分提交、文档完整性要求等）
2. **项目扫描**（始终执行）→ git log 风格分析 + 预检脚本探测 + 文档映射推导

```markdown
# COMMIT RULES

> 由 /xcommit 基于 git log 分析 + CLAUDE.md 生成

更新时间：YYYY-MM-DD
来源：[CLAUDE.md + 项目扫描 / 仅项目扫描]

## 提交消息风格

### 格式
| 项目 | 规范 | 来源 |
|------|------|------|
| 语言 | [如：中文] | [git log 分析] |
| 前缀 | [如：无前缀 / feat: fix: 等] | [git log 分析] |
| 长度 | [如：简短一行] | [git log 分析] |
| 示例 | [从最近提交提取的典型示例] | [git log 分析] |

## 暂存规则

| 规则 | 检查点 | 来源 |
|------|--------|------|
| [如：禁止 git add -A] | [检查暂存命令] | [CLAUDE.md / 项目扫描] |
| [如：每次提交包含所有变更] | [git status 确认无遗漏] | [CLAUDE.md / 项目扫描] |

## 预检脚本

| 脚本 | 用途 | 阻断级别 |
|------|------|----------|
| [如：scripts/preflight.py] | [预提交检查] | [阻断 / 警告] |

## 文档完整性检查

### 变更类型 → 文档映射
| 变更类型 | 判断依据 | 应更新的文档 | 来源 |
|----------|----------|-------------|------|
| Bug 修复 | diff 含修复逻辑 | DEBUG-LOG.md | [CLAUDE.md / 项目扫描] |
| 架构/决策 | 新增/删除模块 | DECIDE-LOG.md | [CLAUDE.md / 项目扫描] |
| 新功能 | 新增文件/函数 | [对应功能文档] | [项目扫描] |

## 提交禁忌（汇总速查）

> 从上面各节提取的禁忌项汇总。

- [ ] [禁忌 1]
- [ ] [禁忌 2]
```

## 更新时机

- `reinit` 时重新生成
- 项目提交规范变化时
- CLAUDE.md 提交相关规则更新后
- 用户手动调整后以用户版本为准

# REVIEW-RULES.md 规范

## 生成方式

两层来源提取（不是凭空编）：
1. **CLAUDE.md**（如存在）→ 关键词搜索提取禁忌/必须/规范/架构规则
2. **代码扫描**（始终执行）→ 推导命名风格、缩进、注释语言、目录结构、架构分层、错误处理模式等

```markdown
# CODE REVIEW RULES

> 由 /xreview 基于代码扫描 + CLAUDE.md 生成

更新时间：YYYY-MM-DD
来源：[CLAUDE.md + 代码扫描 / 仅代码扫描]

## A. 规范合规

### 禁忌（违反则必须修复）
| 规则 | 检查点 | 来源 |
|------|--------|------|
| [如：禁止 print()] | [检查是否存在 print() 调用] | [CLAUDE.md / 代码推导] |

### 必须（遗漏则必须补充）
| 规则 | 检查点 | 来源 |
|------|--------|------|
| [如：日志用 Log.xxx] | [检查日志调用是否使用项目日志框架] | [CLAUDE.md / 代码推导] |

### 编码规范
| 项目 | 规范 | 来源 |
|------|------|------|
| 缩进风格 | [如：4 空格] | [代码扫描] |
| 命名风格 | [如：Swift camelCase / Rust snake_case] | [代码扫描] |
| 注释语言 | [如：中文] | [代码扫描 / CLAUDE.md] |
| 文件组织 | [如：MARK 分段] | [代码扫描] |

## B. 架构质量

### 分层与依赖
| 层级 | 职责 | 依赖方向 | 来源 |
|------|------|----------|------|
| [如：core/] | [领域逻辑] | [不依赖外层] | [CLAUDE.md / 目录结构推导] |

### 模块职责
| 模块/目录 | 职责边界 | 来源 |
|-----------|----------|------|
| [如：Bridge/] | [FFI 桥接] | [代码结构推导] |

### 架构原则
| 原则 | 检查点 | 来源 |
|------|--------|------|
| [如：依赖单向向内] | [检查 import/use 方向] | [CLAUDE.md / 代码推导] |

## C. 安全健壮

### 通用检查点
- 边界条件：空值、越界、类型转换
- 并发安全：共享状态、线程安全
- 资源管理：内存泄漏、文件句柄、循环引用
- 安全漏洞：注入、XSS、权限检查

### 项目特有检查点
| 检查点 | 说明 | 来源 |
|--------|------|------|
| [如：FFI 内存安全] | [跨语言指针/字符串管理] | [代码模式推导] |

## 项目禁忌（汇总速查）

> 从上面各节提取的禁忌项汇总，方便审查时快速核对。

- [ ] [禁忌 1]
- [ ] [禁忌 2]
```

## 更新时机

- `reinit` 时重新生成
- 项目架构发生变化时
- CLAUDE.md 规则更新后
- 用户手动调整后以用户版本为准
